# Brotato核心玩法机制

## 空间与距离系统

理解Brotato的距离计算是掌握游戏机制的基础。

### 基础空间单位

游戏中所有距离相关的数值使用**像素（Pixel）**作为单位：

| 概念 | 尺寸 | 说明 |
|------|------|------|
| **玩家角色** | 约32×32像素 | 角色的碰撞箱/显示大小 |
| **游戏屏幕** | 960×540像素 | 可视区域（16:9比例） |
| **竞技场** | 约1200×800像素 | 实际战斗区域（大于屏幕） |

### 距离参考

| 距离 | 像素值 | 相当于 |
|------|--------|--------|
| 极近距离 | 50-100 | 1.5-3个角色身位 |
| 近距离 | 100-200 | 3-6个角色身位 |
| 中距离 | 200-400 | 6-12个角色身位 |
| 远距离 | 400-600 | 12-18个角色身位 |
| 超远距离 | 600-1000 | 18-30个角色身位（接近全屏） |

### 速度单位

移动速度使用**像素/秒**：

| 速度类型 | 数值范围 | 说明 |
|----------|----------|------|
| 角色基础速度 | **450像素/秒** | 官方基础值（+Speed%会修正此值） |
| 慢速敌人 | 0-200像素/秒 | 树/缓慢追踪/部分远离型 |
| 普通敌人 | 200-380像素/秒 | 大部分常规敌人 |
| 快速敌人 | 380-450像素/秒 | 追击/冲锋/治疗等高压单位 |
| 极速敌人 | 450-600+像素/秒 | 追击者等可加速单位（部分会随时间提升） |

### 攻击范围分类

| 武器类型 | 典型范围 | 说明 |
|----------|----------|------|
| **拳头类近战** | 150像素 | 需要贴脸 |
| **剑类近战** | 175-225像素 | 中等近战范围 |
| **长枪近战** | 350-500像素 | 最长的近战武器 |
| **霰弹枪** | 275-350像素 | 短程远程 |
| **手枪/SMG** | 400-500像素 | 中程远程 |
| **狙击枪** | 800-1000像素 | 超远程（接近全屏） |

### 空间设计的策略意义

1. **走位空间**：竞技场比屏幕大，有走位余地但无法无限逃跑
2. **武器选择**：根据舒适距离选择武器类型
3. **敌人威胁**：快速敌人（高像素/秒）缩短反应时间
4. **Build策略**：远程流保持距离，近战流需要高机动性

---

## 游戏流程

### 整体结构
```
开始游戏 → 选择角色 → 进入第1波战斗 → 商店阶段 → 第2波战斗 → ... → 第20波战斗 → 胜利/失败
```

### 单波流程
```
准备阶段（商店） → 战斗阶段 → 结算阶段 → 下一波准备阶段
```

## 战斗阶段

### 核心机制

1. **自动射击系统**
   - 武器默认自动向最近的敌人射击
   - 玩家无需手动瞄准（可选手动瞄准模式）
   - 玩家主要控制角色移动和走位

2. **多武器同时使用**
   - 最多携带6种武器
   - 所有武器同时攻击
   - 每种武器有独立的攻击间隔和冷却时间

3. **移动与走位**
   - 玩家通过键盘/摇杆控制角色移动
   - 走位是生存的关键
   - 需要在攻击和躲避之间找到平衡

4. **敌人生成**
   - 敌人从地图边缘不断生成
   - 敌人类型和数量随波次递增
   - 每波有固定的时间限制

### 战斗目标
- 击败所有敌人
- 生存至时间结束
- 尽可能收集掉落的资源

## 商店阶段

### 商店机制

1. **购买系统**
   - 使用**材料（Materials）**购买武器、道具与属性提升
   - 使用**材料（Materials）**刷新商店
   - 商店有固定数量的商品槽位

2. **刷新机制**
   - 使用材料可以刷新商店
   - 刷新次数无限
   - **每次刷新所需材料递增**（重要平衡机制）
   - 刷新成本：首次刷新较便宜，之后逐步增加

3. **商品品质系统**
   - 武器和道具分为4个品质等级：
     - 一级（黑色/普通）
     - 二级（蓝色/稀有）
     - 三级（紫色/史诗）
     - 四级（红色/传说）
   - **品质影响因素**：
     - 角色幸运属性
     - 当前波次（波次越高，高品质概率越大）

4. **商品类型**
   - **武器**：提供攻击能力
   - **可叠加道具**：可多次购买，效果累加
   - **唯一道具**：购买后不再出现在商店中
   - **属性升级**：直接提升角色基础属性

5. **武器类型限制**
   - 商店刷新的武器类型受角色和当前持有武器影响
   - 某些角色限制特定武器类型（如角斗士只能用近战）

### 升级系统

1. **经验与升级**
   - 击败敌人获得经验
   - 每波结算时根据经验提升等级
   - 升级后获得属性点或特殊奖励

2. **属性提升**
   - 在商店阶段可以用材料购买属性提升
   - 常见属性包括：
     - 最大生命值
     - 攻击力
     - 攻击速度
     - 暴击率
     - 移动速度
     - 护甲
     - 闪避
     - 生命恢复
     - 幸运值等

## 资源系统

### 两种核心资源

1. **材料（Materials）⭐ 唯一货币**
   - 击败敌人掉落，需要拾取
   - 用于购买武器、道具与属性提升
   - 用于刷新商店

2. **经验值（XP）**
   - 击败敌人掉落
   - 用于角色升级
   - 影响角色实力成长

### 资源管理特色

1. **掉落保留机制**
   - 未拾取的材料会在下一波开始时重新掉落
   - 标识为"x2"提醒玩家
   - 经验值全部自动结算
   - **培养玩家资源经营意识**

2. **收益优化**
   - 通过提升"收获"属性增加资源掉落
   - 某些道具可以提供额外的资源获取
   - 资源获取与风险控制的平衡

## 波次进程

### 20波结构

> 📊 **详细波次时长表**：见 [07-敌人与关卡设计](./07-敌人与关卡设计.md)
> 
> | 波次 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10-19 | 20 |
> |------|---|---|---|---|---|---|---|---|---|-------|-----|
> | 秒数 | 20 | 25 | 30 | 35 | 40 | 45 | 50 | 55 | 60 | 60 | 90 |

- **第1-5波**：入门阶段
  - 敌人较弱
  - 建立基础构筑
  - 积累初始资源

- **第6-10波**：成长阶段
  - 敌人强度提升
  - 构筑初步成型
  - 开始面临选择压力

- **第11-15波**：挑战阶段
  - 敌人强度明显增加
  - 需要优化构筑
  - 资源管理更加重要

- **第16-20波**：终局阶段
  - 最强敌人出现
  - 构筑完全成型
  - 生存压力最大
  - Boss波次（第20波）

### 难度曲线

- **基础数值**：保证前期怪物的基本表现
- **成长数值**：确保怪物随玩家成长
- **平行上升**：保持难度的平衡递增
- 避免出现明显的难度断层

## 游戏节奏

- 战斗阶段：紧张刺激，需要专注
- 商店阶段：策略思考，规划构筑
- 两个阶段交替，张弛有度
- 整体游戏时长控制在30分钟以内


